# Project Structure

## Directory Layout

```
secure_file/
├── client/              # React frontend application
│   ├── src/
│   │   ├── components/  # UI components (shadcn/ui + custom)
│   │   ├── hooks/       # Custom React hooks (use-auth, use-upload, use-toast)
│   │   ├── lib/         # Utilities (API client, auth utils, queryClient)
│   │   ├── pages/       # Route components (landing, dashboard, share-download)
│   │   └── main.tsx     # React entry point
│   ├── index.html       # HTML entry point
│   └── public/          # Static assets
├── server/              # Express backend application
│   ├── replit_integrations/  # Replit Auth and Storage modules
│   ├── index.ts         # HTTP server entry point
│   ├── routes.ts        # API route definitions
│   ├── storage.ts       # Data access layer (Drizzle queries)
│   ├── security.ts      # Security middleware
│   └── db.ts            # Database connection
├── shared/              # Shared types and schemas
│   ├── schema.ts        # Drizzle ORM database schema
│   └── models/          # Type definitions (auth models)
├── docs/                # Architecture documentation
│   ├── architecture/    # System design, modules, flows
│   ├── api/             # REST API reference
│   ├── security/        # Threat model, security docs
│   ├── testing/         # Test patterns and coverage
│   └── data/            # Database schema docs
├── test/                # Test utilities and setup
├── migrations/          # Database migrations (generated by Drizzle)
└── script/              # Build scripts
```

## Module Organization

### Frontend (`client/src/`)
- **components/**: Reusable UI components
  - `ui/`: shadcn/ui primitives (accordion, button, dialog, etc.)
  - Custom components: FileList, FolderBreadcrumb, ObjectUploader, ShareDialog
- **hooks/**: Custom React hooks for auth, uploads, and toasts
- **lib/**: Utilities and API client logic
- **pages/**: Top-level route components

### Backend (`server/`)
- **routes.ts**: All API endpoints (RESTful, require auth except share links)
- **storage.ts**: Data access layer (all database queries)
- **security.ts**: Authentication and authorization middleware
- **db.ts**: Database connection and Drizzle instance
- **replit_integrations/**: External service integrations

### Shared (`shared/`)
- **schema.ts**: Single source of truth for database schema
- Exports Drizzle tables, relations, Zod schemas, and TypeScript types
- Used by both client (types) and server (queries)

## Key Conventions

### File Naming
- React components: PascalCase (e.g., `FileList.tsx`)
- Utilities/hooks: kebab-case (e.g., `use-auth.ts`, `auth-utils.ts`)
- Tests: Co-located with source files using `.test.ts` suffix

### Import Patterns
- Use path aliases: `@/` for client, `@shared/` for shared code
- Server imports from `shared/` use relative paths or `@shared/`
- All imports use ESNext module syntax (`import`/`export`)

### Database Schema
- Tables defined in `shared/schema.ts` using Drizzle ORM
- UUIDs auto-generated via PostgreSQL `gen_random_uuid()`
- Indexes on foreign keys (userId, parentId, folderId) for performance
- Relations define cascade behavior

### API Structure
- Base URL: `/api`
- RESTful conventions: GET (list/read), POST (create), PUT (update), DELETE (delete)
- All endpoints require authentication except `/api/share-links/token/:token`
- Consistent error format: `{ "error": "message", "code": "ERROR_CODE" }`

### Testing
- Unit tests co-located with source files
- Integration tests in `test/` directory
- 100% coverage required for security features and API endpoints
- Test naming: `describe("Component/Function") → it("should behavior when condition")`

## Documentation Structure

- **docs/architecture/**: System design and component relationships
- **docs/api/**: REST API endpoint documentation
- **docs/security/**: Threat model and security policies
- **docs/testing/**: Test patterns and coverage reports
- **docs/adr/**: Architecture Decision Records
